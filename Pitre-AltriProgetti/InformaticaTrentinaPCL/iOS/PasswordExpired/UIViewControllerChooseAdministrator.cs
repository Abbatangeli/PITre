// This file has been autogenerated from a class added in the UI designer.

using System;
using System.Collections.Generic;
using Foundation;
using InformaticaTrentinaPCL.iOS.Helper;
using InformaticaTrentinaPCL.iOS.Login.Session;
using InformaticaTrentinaPCL.Login;
using InformaticaTrentinaPCL.LoginListAdministration;
using InformaticaTrentinaPCL.LoginListAdministration.MVP;
using UIKit;

namespace InformaticaTrentinaPCL.iOS.PasswordExpired
{
    public partial class UIViewControllerChooseAdministrator : UIViewController, IUITableViewDelegate, IUITableViewDataSource,ILoginListAdministrationsView
	{
        public Action<AmministrazioneModel> Callback;
        private LoginListAdministrationsPresenter presenter;
        private List<AmministrazioneModel> list;
        public string username;

		public UIViewControllerChooseAdministrator (IntPtr handle) : base (handle)
		{
		}

        public override void ViewDidLoad()
        {
            base.ViewDidLoad();
            presenter = new LoginListAdministrationsPresenter(this,IosNativeFactory.Instance(),this.username);
			tableView.Delegate = this;
			tableView.DataSource = this;
            this.titlelabel.Text = Utility.LanguageConvert("title_amm");
			Font.SetCustomStyleFont(titlelabel, Font.MODALE_TITLE, UITextAlignment.Center);
            presenter.UpdateList();
		}

		public override void ViewDidLayoutSubviews()
		{
			base.ViewDidLayoutSubviews();
			this.marginLeft.Constant = StyleTablet.MarginRightAndLeftForViewController();
			this.marginRight.Constant = StyleTablet.MarginRightAndLeftForViewController();
			this.marginDown.Constant = StyleTablet.MarginBottomAndTopForViewController();
		}

		public nint RowsInSection(UITableView tableView, nint section)
		{
            return list!=null?list.Count:0;
		}

        [Export("tableView:didSelectRowAtIndexPath:")]
        public void RowSelected(UITableView tableView, NSIndexPath indexPath)
        {
            AmministrazioneModel model = list[indexPath.Row];
            Callback(model);
			DismissViewController(true, null);
        }

		public UITableViewCell GetCell(UITableView tableView, NSIndexPath indexPath)
		{
			string CellIdentifier = "styleIos";
            AmministrazioneModel model = list[indexPath.Row];

            UITableViewCell cell = tableView.DequeueReusableCell(CellIdentifier);

            if (cell == null)
                cell = new UITableViewCell(UITableViewCellStyle.Subtitle, CellIdentifier);

            cell.TextLabel.Text = model.descrizione;
            Font.SetCustomStyleFont(cell.TextLabel, Font.LINK_TO_PAGE_SECTION);
            cell.SelectionStyle = UITableViewCellSelectionStyle.None;
			return cell;
		}

		partial void ActionButtonClose(Foundation.NSObject sender)
        {
            Callback(null);
            DismissViewController(true,null);
        }

        public void UpdateList(List<AmministrazioneModel> list)
        {
            this.list = list;
            tableView.ReloadData();
        }

        public void ShowError(string e, bool isLight)
        {
            ShowErrorHelper.Show(this,isLight,e);
        }

        public void OnUpdateLoader(bool isShow)
        {
            Utility.Loading(this.View, isShow);
        }
    }
}
